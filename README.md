# PyExperimenter
The PyExperimenter is a tool for the automatic execution of various experiments. 
## Installation and configuration
In order to install the package via pip use the command
```
pip install py_experimenter
```
You can also download the git repository and import the py_experimenter manually.

### Configuration file
The configuration file is used to describe the experiment, as well as to make settings for execution.
In addition, the user can create his own configurations, which are passed to the executing function during execution.

Each configuration file consists of three sections:DATABASE, PY_EXPERIMENTER and CUSTOM.
In the following we will go through these sections and go into more detail about the individual configuration parameters.

####DATABASE
The database section contains the credentials for the database where the results of the experiments are written.
```
[DATABASE]
host=<hostname>
user=<username>
database=<databasename>
password=<password>
table=<tablename>
```
Note that the table is automatically generated by PyExperimenter.
In the configuration you should therefore only enter the desired name.

####PY_EXPERIMENTER
In this section of the configuration, the experiment is defined.
```
[PY_EXPERIMENTER]
cpu.max = <number_of_cpus>

keyfields = keyfieldname1, keyfieldname2:int(3)

keyfieldname1=A,B,C
keyfieldname2=1,2,3

resultfields = resultfield1, resultfield2:LONGTEXT
```
First, the number of CPUs available to run the experiments in parallel must be specified.

The keyfields define all parameter names that are needed for the experiment.
These parameters are passed as parameters to the function to be executed.
To determine all possible values for each of the keyfields, these must also be defined in the configuration.
To do this, all possible values are assigned to the respective keyfield, separated by commas.

The resultfields define all names of the results of the experiment.
These must be returned by the function to be executed.

Note that both the keyfields and the resultfields can be assigned a data type.
These must be defined in SQL notation separated from the fieldname by a colon.
If no data type is explicitly specified, `VARCHAR(255)` is used.

####CUSTOM
In the last section you can define your own configurations. These are passed to the function to be executed, where they can then be used.
```
[CUSTOM]
custom.setting1=<value>
custom.setting2=<value>
```






An example of a configuration file can be found in `config/example_config.cfg`.

## How should the function to be executed look like?
To use the PyExperimenter for your experiments, you need to create a function with 3 parameters.
This function will be called by the PyExperimenter to process each instance of the experiment.
```
def own_function(parameters: dict, result_processor: ResultProcessor, custom_config: dict):
```
The first parameter `parameters: dict` contains a dictionary with `keyfieldname: value` entities. You can use the parameters
in you experiment by calling the dictionary with the keyfieldname.

The second parameter `result_processor` is an object of class `ResultProcessor` which process the results
and writes them to the database. In order to write one (or multiple) result(s) to the database, create a
dictionary of resultfieldname and value pairs. After that call the `process_results()` method of the `ResultProcessor`
and pass the dictionary as an argument to write the results to the database. 
```
results = {'resultfield1': value1, 'resultfield2': value2}

result_processor.process_results(results)
```
You can call this method multiple times during the execution of you experiment. Note that you can only write to resultfields
defined in the configuration. If a dictionary with other keys not defined in the configuration file, the results will not be
written to the database.

The third parameter `custom_config: dict` passes all custom configurations defined in the `CUSTOM` section in the configuration
file to the experiment. Note that this parameter is only needed even if you have set your custom configurations.
## Further usage